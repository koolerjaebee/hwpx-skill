# HWPX Format Notes

## Purpose

Use this reference when you need concrete package paths and XML parsing hints for `.hwpx` files.

## Package Model

- Treat `.hwpx` as a ZIP container.
- Expect XML-centric parts similar to other office package formats.
- Validate container integrity first before any XML operation.

## Common Paths

Expected paths commonly used by this skill:

- `mimetype`
- `version.xml`
- `settings.xml`
- `Contents/content.hpf`
- `Contents/header.xml`
- `Contents/section*.xml`

## Header and Sections

- `Contents/header.xml` commonly contains a `head` node with `secCnt` (section count).
- Body content is typically split across `Contents/section0.xml`, `Contents/section1.xml`, etc.
- Validate that `secCnt` and actual section files are consistent when possible.

## Text Extraction Hints

- Paragraph-like nodes are often represented as `p`.
- Text runs are often represented as `t` (for example `hp:t` in namespace form).
- Namespace prefixes can vary by file, so parsing should rely on local tag names, not hardcoded prefixes.

## Safe Editing Strategy

1. Unpack to a temporary workspace.
2. Edit only required XML nodes.
3. Keep file paths and casing intact.
4. Repack and re-run structure validation.
5. Render baseline and edited outputs, then compare before final delivery.

## Quality Validation Gates

Use render artifacts as a mandatory gate for high-confidence changes.
Prefer PDFs generated by Hancom Office for fidelity-critical validation.

Automated gates:

- Page count match
- Page size match (allow tiny float tolerance from conversion)
- Normalized text similarity check
- Per-page pixel diff ratio threshold check

Manual gates:

- Text clipping or overlap
- Table/shape displacement
- Missing images or controls
- Unexpected page breaks

## Known Limitations

- HWPX may include rich objects (tables, shapes, math, controls) that require additional XML handling beyond basic text extraction.
- Simple `p/t` extraction is best-effort and may not preserve full layout semantics.
- Non-Hancom converters may fail to open some HWPX files or produce layout differences.

## Source

- Hancom technical page: https://tech.hancom.com/hwpxformat/
